<?xml version="1.0" encoding="utf-8"?>
<Investigation xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" DataModelVersion="12" SyntaxVersion="2">
  <Label>Threat hunting - Potential malware downloads v1.0</Label>
  <Object>web_request</Object>
  <Platforms>
    <Platform>windows</Platform>
  </Platforms>
  <Description>v1.01 - Common malware download techniques</Description>
  <FieldList>
    <string>time</string>
    <string>last_time</string>
    <string>protocol</string>
    <string>http_status</string>
    <string>source_name</string>
    <string>product_name</string>
    <string>binary_paths</string>
    <string>domain_name</string>
    <string>tcp_in</string>
    <string>tcp_out</string>
  </FieldList>
  <CategoryList />
  <AggregateList />
  <ObjectConditionList>
    <ObjectCondition IsTemplate="false">
      <Object>application</Object>
      <Field>name</Field>
      <Comparer>like</Comparer>
      <Value>"*rundll32.exe*"</Value>
      <Operand>pattern</Operand>
    </ObjectCondition>
    <ObjectCondition IsTemplate="false">
      <Object>domain</Object>
      <Field>name</Field>
      <Comparer>!=</Comparer>
      <Value>"watson.microsoft.com"</Value>
      <Operand>string</Operand>
    </ObjectCondition>
    <ObjectCondition IsTemplate="false">
      <Object>domain</Object>
      <Field>name</Field>
      <Comparer>unlike</Comparer>
      <Value>"*.local"</Value>
      <Operand>pattern</Operand>
    </ObjectCondition>
    <ObjectCondition IsTemplate="false">
      <Object>domain</Object>
      <Field>name</Field>
      <Comparer>unlike</Comparer>
      <Value>"*.live.com"</Value>
      <Operand>pattern</Operand>
    </ObjectCondition>
    <ObjectCondition IsTemplate="false">
      <Object>domain</Object>
      <Field>name</Field>
      <Comparer>unlike</Comparer>
      <Value>"*.public-trust.com"</Value>
      <Operand>pattern</Operand>
    </ObjectCondition>
    <ObjectCondition IsTemplate="false">
      <Object>domain</Object>
      <Field>name</Field>
      <Comparer>unlike</Comparer>
      <Value>"*.microsoftonline.com"</Value>
      <Operand>pattern</Operand>
    </ObjectCondition>
    <ObjectCondition IsTemplate="false">
      <Object>domain</Object>
      <Field>name</Field>
      <Comparer>unlike</Comparer>
      <Value>"*.msocsp.com"</Value>
      <Operand>pattern</Operand>
    </ObjectCondition>
    <ObjectCondition IsTemplate="false">
      <Object>domain</Object>
      <Field>name</Field>
      <Comparer>unlike</Comparer>
      <Value>"*.microsoftonline-p.net"</Value>
      <Operand>pattern</Operand>
    </ObjectCondition>
    <ObjectCondition IsTemplate="false">
      <Object>domain</Object>
      <Field>name</Field>
      <Comparer>unlike</Comparer>
      <Value>"10.*.*.*"</Value>
      <Operand>pattern</Operand>
    </ObjectCondition>
    <ObjectCondition IsTemplate="false">
      <Object>application</Object>
      <Field>name</Field>
      <Comparer>like</Comparer>
      <Value>"*mshta.exe*"</Value>
      <Operand>pattern</Operand>
    </ObjectCondition>
    <ObjectCondition IsTemplate="false">
      <Object>domain</Object>
      <Field>name</Field>
      <Comparer>unlike</Comparer>
      <Value>"*.teamviewer.com"</Value>
      <Operand>pattern</Operand>
    </ObjectCondition>
    <ObjectCondition IsTemplate="false">
      <Object>domain</Object>
      <Field>name</Field>
      <Comparer>unlike</Comparer>
      <Value>"*.microsoft.com"</Value>
      <Operand>pattern</Operand>
    </ObjectCondition>
    <ObjectCondition IsTemplate="false">
      <Object>application</Object>
      <Field>name</Field>
      <Comparer>like</Comparer>
      <Value>"*powershell*"</Value>
      <Operand>pattern</Operand>
    </ObjectCondition>
    <ObjectCondition IsTemplate="false">
      <Object>domain</Object>
      <Field>name</Field>
      <Comparer>unlike</Comparer>
      <Value>"*.verisign.com"</Value>
      <Operand>pattern</Operand>
    </ObjectCondition>
    <ObjectCondition IsTemplate="false">
      <Object>application</Object>
      <Field>name</Field>
      <Comparer>like</Comparer>
      <Value>"*ftp.exe*"</Value>
      <Operand>pattern</Operand>
    </ObjectCondition>
    <ObjectCondition IsTemplate="false">
      <Object>domain</Object>
      <Field>name</Field>
      <Comparer>unlike</Comparer>
      <Value>"*.symcb.com"</Value>
      <Operand>pattern</Operand>
    </ObjectCondition>
    <ObjectCondition IsTemplate="false">
      <Object>domain</Object>
      <Field>name</Field>
      <Comparer>unlike</Comparer>
      <Value>"*.symcd.com"</Value>
      <Operand>pattern</Operand>
    </ObjectCondition>
    <ObjectCondition IsTemplate="false">
      <Object>domain</Object>
      <Field>name</Field>
      <Comparer>unlike</Comparer>
      <Value>"*.microsoftonline-p.com"</Value>
      <Operand>pattern</Operand>
    </ObjectCondition>
    <ObjectCondition IsTemplate="false">
      <Object>domain</Object>
      <Field>name</Field>
      <Comparer>unlike</Comparer>
      <Value>"*.windows.net"</Value>
      <Operand>pattern</Operand>
    </ObjectCondition>
    <ObjectCondition IsTemplate="false">
      <Object>domain</Object>
      <Field>name</Field>
      <Comparer>unlike</Comparer>
      <Value>"*.msftncsi.com"</Value>
      <Operand>pattern</Operand>
    </ObjectCondition>
    <ObjectCondition IsTemplate="false">
      <Object>domain</Object>
      <Field>name</Field>
      <Comparer>unlike</Comparer>
      <Value>"*.windowsupdate.com"</Value>
      <Operand>pattern</Operand>
    </ObjectCondition>
    <ObjectCondition IsTemplate="false">
      <Object>domain</Object>
      <Field>name</Field>
      <Comparer>unlike</Comparer>
      <Value>"*.digicert.com"</Value>
      <Operand>pattern</Operand>
    </ObjectCondition>
    <ObjectCondition IsTemplate="false">
      <Object>domain</Object>
      <Field>name</Field>
      <Comparer>unlike</Comparer>
      <Value>"192.168.*.*"</Value>
      <Operand>pattern</Operand>
    </ObjectCondition>
    <ObjectCondition IsTemplate="false">
      <Object>application</Object>
      <Field>name</Field>
      <Comparer>like</Comparer>
      <Value>"*cscript.exe*"</Value>
      <Operand>pattern</Operand>
    </ObjectCondition>
    <ObjectCondition IsTemplate="false">
      <Object>application</Object>
      <Field>name</Field>
      <Comparer>like</Comparer>
      <Value>"*wscript.exe*"</Value>
      <Operand>pattern</Operand>
    </ObjectCondition>
    <ObjectCondition IsTemplate="false">
      <Object>application</Object>
      <Field>name</Field>
      <Comparer>like</Comparer>
      <Value>"*bitsadmin*"</Value>
      <Operand>pattern</Operand>
    </ObjectCondition>
    <ObjectCondition IsTemplate="false">
      <Object>application</Object>
      <Field>name</Field>
      <Comparer>like</Comparer>
      <Value>"*wmic.exe*"</Value>
      <Operand>pattern</Operand>
    </ObjectCondition>
    <ObjectCondition IsTemplate="false">
      <Object>domain</Object>
      <Field>name</Field>
      <Comparer>unlike</Comparer>
      <Value>"172.16.*.*"</Value>
      <Operand>pattern</Operand>
    </ObjectCondition>
    <ObjectCondition IsTemplate="false">
      <Object>application</Object>
      <Field>name</Field>
      <Comparer>like</Comparer>
      <Value>"*regsvr*"</Value>
      <Operand>pattern</Operand>
    </ObjectCondition>
  </ObjectConditionList>
  <ObjectsConditionsExpression>(1 OR 10 OR 13 OR 15 OR 24 OR 25 OR 26 OR 27 OR 29) AND 2 AND 3 AND 4 AND 5 AND 6 AND 7 AND 8 AND 9 AND 11 AND 12 AND 14 AND 16 AND 17 AND 18 AND 19 AND 20 AND 21 AND 22 AND 23 AND 28</ObjectsConditionsExpression>
  <OrderBy>time</OrderBy>
  <LastDays>7</LastDays>
  <OrderDirection>desc</OrderDirection>
  <Limit>1000</Limit>
</Investigation>